name: Keep Render Alive

on:
  schedule:
    # Run every 7 minutes to prevent Render free tier sleep (10 min inactivity)
    - cron: '*/7 * * * *'
  workflow_dispatch:  # Allow manual trigger

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping health endpoint
        run: |
          curl -f "${{ secrets.RENDER_URL }}/health" || echo "Ping failed, server might be starting up"
      
      - name: Trigger auto crawl
        run: |
          curl -X POST "${{ secrets.RENDER_URL }}/api/scheduler/trigger" \
            -H "Content-Type: application/json" \
            || echo "Scheduler trigger completed"
